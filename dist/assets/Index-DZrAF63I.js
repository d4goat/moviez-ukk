import{u as T}from"./hooks-BxjXLzY_.js";import{h as I,j as p,c as U,O as q,q as D,v as w,e as k,D as E,G as C,E as S,F,m,p as _,x as e,H as j,C as A,y as c,a0 as M,$ as i,w as H,A as B,B as N,Z as K,K as L,l as G}from"./main-B8dzZHEF.js";import{c as O,d as R}from"./index.esm-NSx9nZrM.js";import{u as P}from"./useStudio-BinsPpb_.js";const Q={class:"card bg-component text-bodydark1"},Z={class:"card-header flex justify-between items-center my-3"},z=e("i",{class:"fa-solid fa-circle-xmark"},null,-1),J={class:"card-body"},W={class:"row"},X={class:"col-md-6 flex flex-col"},Y=e("label",{name:"seat_number",class:"form-label"},"Seat Number",-1),ee={class:"col-md-6 flex flex-col"},te=e("label",{name:"studio_id",class:"form-label"},"Studio",-1),se=e("div",{class:"card-footer flex justify-end my-3"},[e("button",{class:"btn btn-md btn-primary",type:"submit"},"Submit")],-1),ae=I({__name:"Form",props:{selected:{default:null,type:String}},emits:["close","refresh"],setup(h,{emit:d}){const l=h,r=d,t=p({}),f=p(),v=O().shape({seat_number:R().required("Seat Number cannot be empty"),studio_id:R().required("Studio cannot be empty")});function y(){E(document.getElementById("form-seat")),C.get(`/master/studio-seats/${l.selected}`).then(({data:s})=>{t.value=s.data}).catch(s=>{console.error(s.response.data.message),S.error(s.response.data.message)}).finally(()=>F(document.getElementById("form-seat")))}function g(){const s=new FormData;s.append("seat_number",t.value.seat_number),s.append("studio_id",t.value.studio_id),E(document.getElementById("form-seat")),l.selected&&s.append("_method","PUT"),C({method:"post",url:l.selected?`/master/seat/${l.selected}`:"/master/seat/store",data:s,headers:{"Content-Type":"multipart/form-data"}}).then(a=>{S.success(a.data.message),r("refresh"),r("close"),f.value.resetForm()}).catch(a=>{console.error(a.response.data.message),S.error(a.response.data.message)}).finally(()=>F(document.getElementById("form-seat")))}const V=P(),x=U(()=>V.data.value?.map(s=>({id:s.id,text:s.name})));return q(()=>{l.selected&&y()}),(s,a)=>{const o=m("Field"),n=m("ErrorMessage"),$=m("select2"),b=m("VForm");return _(),D(b,{"validation-schema":k(v),ref_key:"formRef",ref:f,onSubmit:g,id:"form-seat"},{default:w(()=>[e("div",Q,[e("div",Z,[e("h2",null,j(h.selected?"Edit":"Add")+" Seat ",1),e("button",{type:"button",onClick:a[0]||(a[0]=u=>s.$emit("close")),class:"btn btn-md btn-danger"},[z,A(" Cancel ")])]),e("div",J,[e("div",W,[e("div",X,[Y,c(o,{name:"seat_number",class:"bg-[#232323] border-none focus:ring-[#7C7C7C] rounded-xl p-[11px]",modelValue:t.value.seat_number,"onUpdate:modelValue":a[1]||(a[1]=u=>t.value.seat_number=u),"aria-autocomplete":"off",type:"text",oninput:"this.value = this.value.replace(/[^0-9]/g,'')",placeholder:"Insert Seat Number"},null,8,["modelValue"]),c(n,{name:"name",class:"text-red-500"})]),e("div",ee,[te,c(o,{name:"studio_id",class:"bg-[#232323] border-none focus:ring-[#7c7c7c7] rounded-xl p-[11px]",modelValue:t.value.studio_id,"onUpdate:modelValue":a[3]||(a[3]=u=>t.value.studio_id=u),placeholder:"Select Studio",type:"text",autocomplete:"off"},{default:w(()=>[c($,{options:x.value,modelValue:t.value.studio_id,"onUpdate:modelValue":a[2]||(a[2]=u=>t.value.studio_id=u),class:"form-select-solid",placeholder:"Select Studio"},null,8,["options","modelValue"])]),_:1},8,["modelValue"]),c(n,{name:"studio_id",class:"text-red-500"})])])]),se])]),_:1},8,["validation-schema"])}}}),oe={class:"border-b border-body pb-3"},le={class:"w-full h-full flex flex-col rounded-xl space-y-4"},ne={class:"border-b border-body flex justify-between items-center p-4"},de={class:"flex items-center gap-3"},re=e("i",{class:"la la-arrow-left"},null,-1),ue=[re],ce={class:"text-xl"},ie=e("i",{class:"las la-plus"},null,-1),me={class:"w-full h-full py-2 px-4"},he=I({__name:"Index",setup(h){const d=K(),l=p(null),r=p(""),t=p(!1),f=L(),v=G(),{delete:y}=T({onSuccess:()=>l?.value.refetch()}),{data:g,isLoading:V,refetch:x}=M({queryKey:["stuido"],queryFn:async()=>C.get(`/master/studio/${f.params.uuid}`).then(o=>o.data.data)}),s=[d.accessor("no",{header:"No"}),d.accessor("seat_number",{header:"Seat Number"}),d.accessor("studio.name",{header:"Studio"}),d.accessor("uuid",{header:"Action",cell:o=>i("div",{class:"flex gap-4"},[i("button",{class:"btn btn-md btn-info",onClick:()=>{r.value=o.getValue(),t.value=!0}},[i("i",{class:"la la-pencil fs-2"})]),i("button",{class:"btn btn-md btn-danger",onClick:()=>y(`/master/seat/${o.getValue()}`)},[i("i",{class:"la la-trash fs-2"})])])})],a=()=>l.value.refetch();return H(t,o=>{o||(r.value=""),window.scrollTo(0,0)}),q(()=>x()),(o,n)=>{const $=m("paginate");return _(),B("main",oe,[t.value?(_(),D(ae,{key:0,selected:r.value,onClose:n[0]||(n[0]=b=>t.value=!1),onRefresh:a},null,8,["selected"])):N("",!0),e("div",le,[e("div",ne,[e("div",de,[e("button",{type:"button",onClick:n[1]||(n[1]=b=>k(v).push({name:"master.studio"})),class:"btn btn-sm btn-icon hover:text-blue-700 hover:bg-slate-900 text-bodydark bg-slate-800"},ue),e("h2",ce,j(k(g)?.name)+" Seat List ",1)]),t.value?N("",!0):(_(),B("button",{key:0,type:"button",onClick:n[2]||(n[2]=b=>t.value=!0),class:"btn btn-md btn-primary"},[ie,A("Add")]))]),e("div",me,[c($,{ref_key:"paginateRef",ref:l,url:"/master/seat",id:"table-seat",payload:{uuid_studio:o.$route.params.uuid},columns:s},null,8,["payload"])])])])}}});export{he as default};
