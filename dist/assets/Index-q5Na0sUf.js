import{h as I,j as u,c as T,O as R,q as D,v as V,e as k,D as w,G as F,E as $,F as E,m as i,p as b,x as e,H as q,C as j,y as d,a0 as U,$ as m,w as M,A as B,B as N,Z as H,K,l as G}from"./main-B8dzZHEF.js";import{u as L}from"./useFilm-rpeQrTzO.js";import{c as O,a as S}from"./index.esm-NSx9nZrM.js";import{u as P}from"./hooks-BxjXLzY_.js";const Q={class:"card bg-component text-bodydark"},Z={class:"card-header flex justify-between items-center my-3"},z=e("i",{class:"la la-times-circle"},null,-1),J={class:"card-body"},W={class:"row"},X={class:"col-md-6 flex flex-col mb-3"},Y=e("label",{class:"form-label"},"Cast Name",-1),ee={class:"col-md-6 flex flex-col mb-3"},te=e("label",{class:"form-label"},"Film",-1),se=e("div",{class:"card-footer flex justify-end my-3"},[e("button",{class:"btn btn-md btn-primary ms-auto",type:"submit"},"Submit")],-1),ae=I({__name:"Form",props:{selected:{type:String,default:null}},emits:["close","refresh"],setup(h,{emit:n}){const l=h,c=n,s=u({}),v=O().shape({cast_name:S().required("Name cannot be empty"),film_id:S().required("Film cannot be empty")}),f=u();function y(){w(document.getElementById("form-cast")),F.get(`/master/film-cast/${l.selected}`).then(({data:a})=>{s.value=a.data}).catch(a=>{console.error(a.response.data.message),$.error(a.response.data.message)}).finally(()=>E(document.getElementById("form-cast")))}function g(){const a=new FormData;a.append("cast_name",s.value.cast_name),a.append("film_id",s.value.film_id),l.selected&&a.append("_method","PUT"),w(document.getElementById("form-cast")),F({method:"post",url:l.selected?`/master/film-cast/${l.selected}`:"/master/film-cast/store",data:a,headers:{"Content-Type":"multipart/form-data"}}).then(()=>{$.success("Data saved successfully"),f.value.resetForm(),c("close"),c("refresh")}).catch(t=>[console.error(t.response.data.message),$.error(t.response.data.message)]).finally(()=>E(document.getElementById("form-cast")))}const x=L(),C=T(()=>x.data.value?.map(a=>({id:a.id,text:a.title})));return R(()=>{l.selected&&y()}),(a,t)=>{const o=i("Field"),p=i("ErrorMessage"),_=i("select2"),A=i("VForm");return b(),D(A,{"validation-schema":k(v),ref_key:"formRef",ref:f,onSubmit:g,id:"form-cast"},{default:V(()=>[e("div",Q,[e("div",Z,[e("h2",null,q(h.selected?"Edit":"Add")+" Film Cast ",1),e("button",{type:"button",class:"btn btn-md bg-red-600 hover:bg-red-700",onClick:t[0]||(t[0]=r=>a.$emit("close"))},[z,j(" Cancel ")])]),e("div",J,[e("div",W,[e("div",X,[Y,d(o,{name:"cast_name",modelValue:s.value.cast_name,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value.cast_name=r),autocomplete:"off",class:"bg-[#232323] border-none focus:ring-[#7C7C7C] rounded-xl p-2.5",placeholder:"Insert Cast Name"},null,8,["modelValue"]),d(p,{name:"cast_name",class:"text-red-500"})]),e("div",ee,[te,d(o,{name:"film_id",modelValue:s.value.film_id,"onUpdate:modelValue":t[3]||(t[3]=r=>s.value.film_id=r),class:"bg-[#232323] border-none focus:ring-[#7C7C7C] rounded-xl p-2.5",placeholder:"Select Film"},{default:V(()=>[d(_,{class:"form-select-solid",placeholder:"Select FIlm",options:C.value,modelValue:s.value.film_id,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value.film_id=r)},null,8,["options","modelValue"])]),_:1},8,["modelValue"]),d(p,{name:"film_id",class:"text-red-500"})])])]),se])]),_:1},8,["validation-schema"])}}}),le={class:"border-b-[1px] border-body pb-3"},oe={class:"w-full h-full flex flex-col rounded-xl space-y-4"},ne={class:"border-b-[1px] border-body flex justify-between items-center p-4"},ce={class:"flex items-center gap-3"},re=e("i",{class:"la la-arrow-left"},null,-1),de=[re],me={class:"text-xl"},ie=e("i",{class:"las la-plus"},null,-1),ue={class:"w-full h-full py-2 px-4"},he=I({__name:"Index",setup(h){const n=H(),l=u(null),c=u(""),s=u(!1),v=K(),f=G(),{data:y,refetch:g}=U({queryKey:["films"],queryFn:async()=>await F.get(`/master/film/${v.params.uuid}`).then(t=>t.data.data)}),{delete:x}=P({onSuccess:()=>l.value?.refetch()}),C=[n.accessor("no",{header:"No"}),n.accessor("cast_name",{header:"Name"}),n.accessor("film.title",{header:"Film"}),n.accessor("uuid",{header:"Action",cell:t=>m("div",{class:"flex gap-4"},[m("button",{class:"btn btn-sm bg-purple-600 hover:bg-purple-700",onClick:()=>{c.value=t.getValue(),s.value=!0}},[m("i",{class:"la la-pencil fs-2"})]),m("button",{class:"btn btn-sm bg-red-600 hover:bg-red-700",onClick:()=>x(`/master/film-cast/${t.getValue()}`)},[m("i",{class:"las la-trash fs-2"})])])})],a=()=>l.value.refetch();return M(s,()=>{s.value||(c.value=""),window.scrollTo(0,0)}),R(()=>g()),(t,o)=>{const p=i("paginate");return b(),B("main",le,[s.value?(b(),D(ae,{key:0,selected:c.value,onClose:o[0]||(o[0]=_=>s.value=!1),onRefresh:a},null,8,["selected"])):N("",!0),e("div",oe,[e("div",ne,[e("div",ce,[e("button",{type:"button",class:"btn btn-sm btn-icon hover:text-blue-700 hover:bg-slate-900 text-bodydark bg-slate-800",onClick:o[1]||(o[1]=_=>k(f).push({name:"master.film"}))},de),e("h2",me,q(k(y)?.title)+" Cast List",1)]),s.value?N("",!0):(b(),B("button",{key:0,type:"button",onClick:o[2]||(o[2]=_=>s.value=!0),class:"btn btn-md btn-primary"},[ie,j(" Add ")]))]),e("div",ue,[d(p,{ref_key:"paginateRef",ref:l,url:"/master/film-cast",id:"table-cast",columns:C,payload:{uuid:t.$route.params.uuid}},null,8,["payload"])])])])}}});export{he as default};
